"use strict";(self.webpackChunkfacerecognitionbrain=self.webpackChunkfacerecognitionbrain||[]).push([[3318],{3318:(t,e,i)=>{i.d(e,{EmittersCanvasShapeGenerator:()=>g});var s=i(3532),o=i(4409);const n={x:0,y:0};function a(t,e,i){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const o=t.getImageData(n.x,n.y,e.width,e.height).data;s&&t.clearRect(n.x,n.y,e.width,e.height);const a=[];for(let n=0;n<o.length;n+=i){const t=n/i,s={x:t%e.width,y:Math.floor(t/e.width)};a[s.y]||(a[s.y]=[]);const c={r:0,g:1,b:2,a:3},r=255;a[s.y][s.x]={r:o[n+c.r],g:o[n+c.g],b:o[n+c.b],a:o[n+c.a]/r}}return{pixels:a,width:Math.min(...a.map((t=>t.length))),height:a.length}}class c extends s.B{constructor(t,e,i,s){super(t,e,i,s);const n=s.filter;let a=t=>t.a>0;if(void 0!==n)if((0,o.Kg)(n)){if(Object.hasOwn(window,n)){const t=window[n];(0,o.Tn)(t)&&(a=t)}}else a=n;this.filter=a,this.scale=s.scale,this.pixelData={pixels:[],height:0,width:0}}async init(){let t;const e=this.options,i=e.selector,s=e.pixels,c=e.image,r=e.element,l=e.text,h=s.offset;if(c){const e=c.src;if(!e)return;t=await function(t,e){const i=new Image;i.crossOrigin="Anonymous";const s=new Promise(((t,s)=>{i.onerror=s,i.onload=()=>{const c=document.createElement("canvas");c.width=i.width,c.height=i.height;const r=c.getContext("2d");if(!r)return s(new Error("".concat(o.dI," Could not get canvas context")));r.drawImage(i,n.x,n.y,i.width,i.height,n.x,n.y,c.width,c.height),t(a(r,c,e))}}));return i.src=t,s}(e,h)}else if(l){const e=function(t,e,i){const s=document.createElement("canvas"),c=s.getContext("2d"),{font:r,text:l,lines:h,color:d}=t;if(!l||!c)return;const f=l.split(h.separator),g=(0,o.Et)(r.size)?"".concat(r.size,"px"):r.size,x=[];let u=0,p=0;for(const o of f){c.font="".concat(r.style||""," ").concat(r.variant||""," ").concat(r.weight||""," ").concat(g," ").concat(r.family);const t=c.measureText(o),e={measure:t,text:o,height:t.actualBoundingBoxAscent+t.actualBoundingBoxDescent,width:t.width};u=Math.max(u||0,e.width),p+=e.height+h.spacing,x.push(e)}s.width=u,s.height=p;let w=0;for(const o of x)c.font="".concat(r.style||""," ").concat(r.variant||""," ").concat(r.weight||""," ").concat(g," ").concat(r.family),i?(c.fillStyle=d,c.fillText(o.text,n.x,w+o.measure.actualBoundingBoxAscent)):(c.strokeStyle=d,c.strokeText(o.text,n.x,w+o.measure.actualBoundingBoxAscent)),w+=o.height+h.spacing;return a(c,s,e)}(l,h,this.fill);if(!e)return;t=e}else if(null!==r&&void 0!==r?r:i){const e=null!==r&&void 0!==r?r:i&&document.querySelector(i);if(!e)return;const s=e.getContext("2d");if(!s)return;t=a(s,e,h)}t&&(this.pixelData=t)}async randomPosition(){const{height:t,width:e}=this.pixelData,i=this.pixelData,s=this.position,n=this.scale,a=s.x-e*n*.5,c=s.y-t*n*.5;for(let r=0;r<100;r++){const s=Math.floor((0,o.G0)()*e*t),r={x:s%e,y:Math.floor(s/e)},l=i.pixels[r.y][r.x];if(this.filter(l))return Promise.resolve({position:{x:r.x*n+a,y:r.y*n+c},color:{...l},opacity:l.a})}return Promise.resolve(null)}resize(t,e){super.resize(t,e)}}class r{constructor(){this.offset=4}load(t){t&&void 0!==t.offset&&(this.offset=t.offset)}}class l{constructor(){this.family="Verdana",this.size=32,this.style="",this.variant="",this.weight=""}load(t){t&&(void 0!==t.family&&(this.family=t.family),void 0!==t.size&&(this.size=t.size),void 0!==t.style&&(this.style=t.style),void 0!==t.variant&&(this.variant=t.variant),void 0!==t.weight&&(this.weight=t.weight))}}class h{constructor(){this.separator="\n",this.spacing=0}load(t){t&&(void 0!==t.separator&&(this.separator=t.separator),void 0!==t.spacing&&(this.spacing=t.spacing))}}class d{constructor(){this.color="#000000",this.font=new l,this.lines=new h,this.text=""}load(t){t&&(void 0!==t.color&&(this.color=t.color),this.font.load(t.font),this.lines.load(t.lines),void 0!==t.text&&(this.text=t.text))}}class f{constructor(){this.filter=t=>t.a>0,this.pixels=new r,this.scale=1,this.selector="",this.text=new d}load(t){t&&(void 0!==t.element&&(this.element=t.element),void 0!==t.filter&&(this.filter=t.filter),this.pixels.load(t.pixels),void 0!==t.scale&&(this.scale=t.scale),void 0!==t.selector&&(this.selector=t.selector),void 0!==t.image&&(this.image=t.image),this.text.load(t.text))}}class g{generate(t,e,i,s){const o=new f;return o.load(s),new c(t,e,i,o)}}},3532:(t,e,i)=>{i.d(e,{B:()=>s});class s{constructor(t,e,i,s){this.position=t,this.size=e,this.fill=i,this.options=s}resize(t,e){this.position=t,this.size=e}}}}]);
//# sourceMappingURL=3318.097e61b8.chunk.js.map