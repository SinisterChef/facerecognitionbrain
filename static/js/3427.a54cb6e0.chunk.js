"use strict";(self.webpackChunkfacerecognitionbrain=self.webpackChunkfacerecognitionbrain||[]).push([[3427],{3427:(t,e,n)=>{n.d(e,{CanvasMaskInstance:()=>r});var o=n(4409);const i={x:0,y:0};async function a(t,e,n,i,a,c){const{height:r,width:l}=e,h=r*l,u=function(t){const e=1,n=0;for(let i=t.length-e;i>=n;i--){const e=Math.floor((0,o.G0)()*i);[t[i],t[e]]=[t[e],t[i]]}return t}(s(h)),d=Math.min(h,t.actualOptions.particles.number.value),g=t.canvas.size;let f=0;const x=g.width*n.x/o.a5-l*i*.5,v=g.height*n.y/o.a5-r*i*.5;for(;f<d&&u.length;){var w;const n=0,o=null!==(w=u.pop())&&void 0!==w?w:n,s={x:o%l,y:Math.floor(o/l)},r=e.pixels[s.y][s.x];if(!c(r))continue;const h={x:s.x*i+x,y:s.y*i+v},d={};a.color&&(d.color={value:r}),a.opacity&&(d.opacity={value:r.a}),await t.particles.addParticle(h,d),f++}}function c(t,e,n){let o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const a=t.getImageData(i.x,i.y,e.width,e.height).data;o&&t.clearRect(i.x,i.y,e.width,e.height);const c=[];for(let i=0;i<a.length;i+=n){const t=i/n,o={x:t%e.width,y:Math.floor(t/e.width)};c[o.y]||(c[o.y]=[]);const s={r:0,g:1,b:2,a:3},r=255;c[o.y][o.x]={r:a[i+s.r],g:a[i+s.g],b:a[i+s.b],a:a[i+s.a]/r}}return{pixels:c,width:Math.min(...c.map((t=>t.length))),height:c.length}}const s=t=>[...Array(t).keys()];class r{constructor(t){this._container=t}async init(){var t;const e=this._container,n=e.actualOptions.canvasMask;if(null===n||void 0===n||!n.enable)return;let s={pixels:[],height:0,width:0};const r=n.pixels.offset;if(n.image){const t=n.image.src;if(!t)return;s=await function(t,e){const n=new Image;n.crossOrigin="Anonymous";const a=new Promise(((t,a)=>{n.onerror=a,n.onload=()=>{const s=document.createElement("canvas");s.width=n.width,s.height=n.height;const r=s.getContext("2d");if(!r)return a(new Error("".concat(o.dI," Could not get canvas context")));r.drawImage(n,i.x,i.y,n.width,n.height,i.x,i.y,s.width,s.height),t(c(r,s,e))}}));return n.src=t,a}(t,r)}else if(n.text){const t=function(t,e){const n=document.createElement("canvas"),a=n.getContext("2d"),{font:s,text:r,lines:l,color:h}=t;if(!r||!a)return;const u=r.split(l.separator),d=(0,o.Et)(s.size)?"".concat(s.size,"px"):s.size,g=[];let f=0,x=0;for(const o of u){var v,w,y;a.font="".concat(null!==(v=s.style)&&void 0!==v?v:""," ").concat(null!==(w=s.variant)&&void 0!==w?w:""," ").concat(null!==(y=s.weight)&&void 0!==y?y:""," ").concat(d," ").concat(s.family);const t=a.measureText(o),e={measure:t,text:o,height:t.actualBoundingBoxAscent+t.actualBoundingBoxDescent,width:t.width};f=Math.max(f||0,e.width),x+=e.height+l.spacing,g.push(e)}n.width=f,n.height=x;let m=0;for(const o of g){var p,b,M;a.font="".concat(null!==(p=s.style)&&void 0!==p?p:""," ").concat(null!==(b=s.variant)&&void 0!==b?b:""," ").concat(null!==(M=s.weight)&&void 0!==M?M:""," ").concat(d," ").concat(s.family),a.fillStyle=h,a.fillText(o.text,i.x,m+o.measure.actualBoundingBoxAscent),m+=o.height+l.spacing}return c(a,n,e)}(n.text,r);if(!t)return;s=t}else if(null!==(t=n.element)&&void 0!==t?t:n.selector){var l;const t=null!==(l=n.element)&&void 0!==l?l:n.selector&&document.querySelector(n.selector);if(!t)return;const e=t.getContext("2d");if(!e)return;s=c(e,t,r)}await a(e,s,n.position,n.scale,n.override,n.pixels.filter)}}}}]);
//# sourceMappingURL=3427.a54cb6e0.chunk.js.map